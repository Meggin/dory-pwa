/*!
 *
 *  Web Starter Kit
 *  Copyright 2015 Google Inc. All rights reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *    https://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License
 *
 */
!function(){"use strict";function e(e,t,n,s){var a={author:t,uid:e,questionBody:s,title:n,starCount:0},i=firebase.database().ref().child("questions").push().key,o={};return o["/questions/"+i]=a,o["/user-questions/"+e+"/"+i]=a,firebase.database().ref().update(o)}function t(e,t){e.transaction(function(e){return e&&(e.stars&&e.stars[t]?(e.starCount--,e.stars[t]=null):(e.starCount++,e.stars||(e.stars={}),e.stars[t]=!0)),e})}function n(e,n,s,o,r){var l=firebase.auth().currentUser.uid,u='<li class="question"><div><h4 class="title"></h4><div class="username mdl-color-text--black"></div><div class="key mdl-color-text--black"></div><span class="star"><div class="not-starred material-icons">star_border</div><div class="starred material-icons">star</div><div class="star-count">0</div></span><div class="questionBody"></div><button class="comments mdl-button mdl-js-button mdl-button--icon"><i class="material-icons">comment</i></button></div></li>',d=document.createElement("div");d.innerHTML=u;var c=d.firstChild,m=c.getElementsByClassName("starred")[0],v=c.getElementsByClassName("not-starred")[0],y=c.getElementsByClassName("comments")[0];c.getElementsByClassName("questionBody")[0].innerText=s,c.getElementsByClassName("title")[0].innerText=n,c.getElementsByClassName("username")[0].innerText=o||"Anonymous",c.getElementsByClassName("key")[0].innerText=e;var h=firebase.database().ref("questions/"+e+"/starCount");h.on("value",function(e){i(c,e.val())});var g=firebase.database().ref("questions/"+e+"/stars/"+l);g.on("value",function(e){a(c,e.val())}),U.push(h),U.push(g);var b=function(){var n=firebase.database().ref("/questions/"+e),s=firebase.database().ref("/user-questions/"+r+"/"+e);t(n,l),t(s,l)},B=function(){f(n,e,s,T)};return v.onclick=b,m.onclick=b,y.onclick=B,c}function s(e,t,n,s){var a=(firebase.auth().currentUser.uid,'<div class=" answer mdl-card mdl-shadow--2dp"><div class="header"><div><div class="username mdl-color-text--black"></div></div><div class="key"></div></div><div class="answer"></div></div>'),i=document.createElement("div");i.innerHTML=a;var o=i.firstChild;return o.getElementsByClassName("answer")[0].innerText=n,o.getElementsByClassName("username")[0].innerText=s||"Anonymous",o.getElementsByClassName("key")[0].innerText=e,o}function a(e,t){t?(e.getElementsByClassName("starred")[0].style.display="inline-block",e.getElementsByClassName("not-starred")[0].style.display="none"):(e.getElementsByClassName("starred")[0].style.display="none",e.getElementsByClassName("not-starred")[0].style.display="inline-block")}function i(e,t){e.getElementsByClassName("star-count")[0].innerText=t}function o(){var e=firebase.auth().currentUser.uid,t=firebase.database().ref("questions").orderByChild("starCount"),s=firebase.database().ref("user-questions/"+e).orderByChild("starCount"),a=function(e,t){e.on("child_added",function(e){var s=e.val().author||"Anonymous",a=t.getElementsByClassName("questions-container")[0];a.insertBefore(n(e.key,e.val().title,e.val().questionBody,s,e.val().uid),a.firstChild)})};a(t,N),a(s,x),U.push(t),U.push(s)}function r(e){var t=firebase.database().ref("question-answers/"+e),n=function(e,t,n){e.on("child_added",function(e){var n=(e.val().author||"Anonymous",T.getElementsByClassName("answers-container")[0]);n.insertBefore(s(t,e.val().id,e.val().answer,e.val().author),n.firstChild)})};n(t,e,T),U.push(t),t.off("child_added")}function l(e,t,n,s){firebase.database().ref("users/"+e).set({username:t,email:n})}function u(){N.getElementsByClassName("questions-container")[0].innerHTML="",x.getElementsByClassName("questions-container")[0].innerHTML="",U.forEach(function(e){e.off()}),U=[]}function d(e){e&&h===e.uid||!e&&null===h||(h=e?e.uid:null,u(),e?(k.style.display="none",l(e.uid,e.displayName,e.email),o()):k.style.display="")}function c(t,n){var s=firebase.auth().currentUser.uid;return firebase.database().ref("/users/"+s).once("value").then(function(s){var a=s.val().username;return e(firebase.auth().currentUser.uid,a,t,n)})}function m(e,t,n){firebase.database().ref("question-answers/"+e).push({answer:t,author:n})}function v(e,t){N.style.display="none",x.style.display="none",w.style.display="none",T.style.display="none",L.classList.remove("is-active"),A.classList.remove("is-active"),e&&(e.style.display="block"),t&&t.classList.add("is-active")}function f(e,t,n,s){T.style.display="block",N.style.display="none",x.style.display="none",w.style.display="none",document.getElementById("questiontitle-holder").value=e,document.getElementById("questiontitle-holder").innerText=e,document.getElementById("questionid-holder").value=t,document.getElementById("questionid-holder").innerText=t,document.getElementById("questiontext-holder").value=n,document.getElementById("questiontext-holder").innerText=n,r(t)}var y=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator&&("https:"===window.location.protocol||y)&&navigator.serviceWorker.register("service-worker.js").then(function(e){e.onupdatefound=function(){if(navigator.serviceWorker.controller){var t=e.installing;t.onstatechange=function(){switch(t.state){case"installed":break;case"redundant":throw new Error("The installing service worker became redundant.")}}}}})["catch"](function(e){console.error("Error during service worker registration:",e)});var h,g=document.getElementById("question-form"),b=document.getElementById("new-question-description"),B=document.getElementById("new-question-title"),E=document.getElementById("add-answer"),p=document.getElementById("answer-input"),q=document.getElementById("sign-in-button"),C=document.getElementById("sign-out-button"),k=document.getElementById("page-splash"),w=document.getElementById("add-question"),I=document.getElementById("add"),N=document.getElementById("all-questions-list"),x=document.getElementById("user-questions-list"),T=document.getElementById("question-comments-list"),L=document.getElementById("menu-questions"),A=document.getElementById("menu-my-questions"),U=[];window.addEventListener("load",function(){q.addEventListener("click",function(){var e=new firebase.auth.GoogleAuthProvider;firebase.auth().signInWithPopup(e)}),C.addEventListener("click",function(){firebase.auth().signOut()}),firebase.auth().onAuthStateChanged(d),E.onsubmit=function(e){e.preventDefault();var t=p.value,n=document.getElementById("questionid-holder").value;m(n,t,firebase.auth().currentUser.displayName),r(n),p.value=""},g.onsubmit=function(e){e.preventDefault();var t=b.value,n=B.value;t&&n&&(c(n,t).then(function(){A.click()}),b.value="",B.value="")},L.onclick=function(){v(N,L)},A.onclick=function(){v(x,A)},I.onclick=function(){v(w),b.value="",B.value=""},L.onclick()},!1)}();
//# sourceMappingURL=main.min.js.map
